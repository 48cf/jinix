name=util-linux
from_source=util-linux
revision=1
hostdeps="gcc autoconf automake libtool pkg-config"
deps="core-libs"

build() {
    ${source_dir}/configure \
        ADJTIME_PATH=/var/lib/hwclock/adjtime \
        --prefix=${prefix} \
        --host=${OS_TRIPLET} \
        --bindir=${prefix}/bin \
        --sbindir=${prefix}/bin \
        --libdir=${prefix}/lib \
        --libexecdir=${prefix}/lib \
        --localstatedir=/var \
        --sysconfdir=/etc \
        --disable-makeinstall-chown \
        --disable-chfn-chsh \
        --disable-login \
        --disable-nologin \
        --disable-su \
        --disable-setpriv \
        --disable-runuser \
        --disable-pylibmount \
        --disable-static \
        --without-python \
        --docdir=${prefix}/share/doc/util-linux-${version}

    make -j${parallelism}
}

package() {
    DESTDIR="${dest_dir}" make install-strip

    # util-linux has no way to customize usrsbin_execdir
    mv -v ${dest_dir}${prefix}/sbin/* ${dest_dir}${prefix}/bin/
    rm -rvf ${dest_dir}${prefix}/sbin
}
