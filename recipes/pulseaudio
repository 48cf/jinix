name=pulseaudio
from_source=pulseaudio
revision=1
builddeps="base fftw gettext libtool meson ninja perl perl-xml-parser"
deps="core-libs alsa-lib dbus eudev glib gtk+-3 libsamplerate libsndfile libxtst speex"

build() {
    cp -rp "${source_dir}"/. ./

    mkdir -p build
    cd build
    meson setup \
        --prefix=${prefix} \
        --sysconfdir=/etc \
        --libdir=lib \
        --buildtype=release \
        -Ddatabase=simple \
        -Ddoxygen=false \
        -Dbluez5=disabled \
        -Dtests=false \
        ..

    ninja -j${parallelism}
}

package() {
    DESTDIR="${dest_dir}" ninja -C build install

    rm -fv /etc/dbus-1/system.d/pulseaudio-system.conf

    post_package_strip
}
