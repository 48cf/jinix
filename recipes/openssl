name=openssl
from_source=openssl
revision=1
builddeps="base perl"
deps="core-libs zlib"

build() {
    ${source_dir}/Configure \
        --prefix=${prefix} \
        --openssldir=/etc/ssl \
        --libdir=lib \
        shared \
        zlib-dynamic \
        no-afalgeng \
        linux-x86_64

    make -j${parallelism}
}

package() {
    # Disable installing static libraries.
    sed -i '/INSTALL_LIBS/s/libcrypto.a libssl.a//' Makefile

    DESTDIR="${dest_dir}" make DESTDIR="${dest_dir}" MANSUFFIX=ssl install

    post_package_strip
}
